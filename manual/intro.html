<h3 id="un-exemple-de-bienvenue">Un exemple de bienvenue</h3>
<p>Voilà un premier exemple donnant une idée générale de ce qu'est <code>dyndoc</code>. Le code source suivant (enregistré dans la fichier <code>hello.dyn</code>) propose l'habituel exemple <code>hello</code> fourni pour présenter un nouveau langage.</p>
<pre class="solarized"><span class="line-numbers">   1 </span> [#<span class="Keyword">R&lt;</span>]<span class="Comment"><span class="Comment">#</span> R code without output since R&lt;</span>
<span class="line-numbers">   2 </span> <span class="Variable">who</span> <span class="Keyword">&lt;-</span> <span class="QuotedString"><span class="Quotes">&quot;</span>MisteR<span class="Quotes">&quot;</span></span>
<span class="line-numbers">   3 </span> [#<span class="Keyword">rb&lt;</span>]<span class="Comment"><span class="Comment">#</span> ruby code without output since rb&lt;</span>
<span class="line-numbers">   4 </span> who <span class="Keyword">=</span> <span class="QuotedString"><span class="RubyPunctuationSection">&quot;</span>Miss Ruby<span class="RubyPunctuationSection">&quot;</span></span>
<span class="line-numbers">   5 </span> [#<span class="Keyword">&lt;</span>]<span class="DiffDeleted"> No output since &lt;.</span>
<span class="line-numbers">   6 </span> <span class="DiffDeleted">Next, definition of function hello</span>
<span class="line-numbers">   7 </span> <span class="DiffDeleted"></span>
<span class="line-numbers">   8 </span> <span class="DiffDeleted"><span class="DiffDeleted">{#</span><span class="Keyword">def</span><span class="DiffDeleted">]</span>hello<span class="DiffDeleted">[#</span><span class="Keyword">,</span><span class="DiffDeleted">]</span>name[Miss]<span class="DiffDeleted">[#</span><span class="Keyword">&gt;</span><span class="DiffDeleted">]</span><span class="DiffInserted"></span></span>
<span class="line-numbers">   9 </span> <span class="DiffDeleted"><span class="DiffInserted"><span class="Invalid">  <span class="Invalid">[</span></span>from Dyn, Hello <span class="Comment">#{</span><span class="Variable">name</span><span class="Comment">}</span><span class="Invalid"><span class="Invalid">]</span></span></span></span>
<span class="line-numbers">  10 </span> <span class="DiffDeleted"><span class="DiffInserted"></span><span class="DiffDeleted">[#</span><span class="DiffDeleted">}</span></span>
<span class="line-numbers">  11 </span> <span class="DiffDeleted"></span>
<span class="line-numbers">  12 </span> <span class="DiffDeleted"></span>[#<span class="Keyword">&gt;</span>]<span class="DiffInserted"></span>
<span class="line-numbers">  13 </span> <span class="DiffInserted"></span>
<span class="line-numbers">  14 </span> <span class="DiffInserted"><span class="Invalid">  <span class="Invalid">[</span></span><span class="DiffInserted">{#</span><span class="Keyword">hello</span><span class="DiffInserted">#}</span></span>
<span class="line-numbers">  15 </span> <span class="DiffInserted"><span class="Invalid">  <span class="Invalid">|</span></span><span class="DiffInserted">{#</span><span class="TagName">hello</span><span class="DiffInserted">]</span>Mister<span class="DiffInserted">[#</span><span class="DiffInserted">}</span></span>
<span class="line-numbers">  16 </span> <span class="DiffInserted"><span class="Invalid">  <span class="Invalid">|</span></span>from ruby, Hello <span class="Comment">:{</span><span class="Variable">who</span><span class="Comment">}</span></span>
<span class="line-numbers">  17 </span> <span class="DiffInserted"><span class="Invalid">  <span class="Invalid">|</span></span>from R, Hello <span class="Comment">:r{</span><span class="Variable">who</span><span class="Comment">}</span><span class="Invalid"><span class="Invalid">]</span></span></span>
</pre>
<p>Et voici le résultat obtenu à partir de la ligne de commande <code>dyn  hello.dyn</code> :</p>
<pre class="dynres">
from Dyn, Hello Miss
from Dyn, Hello Mister
from ruby, Hello Miss Ruby
from R, Hello MisteR
</pre>
<h3 id="commentaires-généraux-sur-lexemple-de-bienvenue">Commentaires généraux sur l'exemple de bienvenue</h3>
<p>Le code est découpé en 4 parties délimitées par les balises <code><em>[#r&lt;]</em></code>, <code><em>[#rb&lt;]</em></code>, <code><em>[#&lt;]</em></code> et <code><em>[#&gt;]</em></code>. La première permet de réaliser un traitement <code>R</code> (ici très sommaire). La deuxième réalise un traitement <code>ruby</code>. La troisième popose la définition d'une fonction <code>hello</code> (déclarée en <code>dyndoc</code> entre les balises <code><em>{#def]</em></code> et <code><em>[#def}</em></code>) utilisée dans la quatrième et dernière partie (via les appels <code><em>{#hello#}</em></code> et <code><em>{#hello]Mister[#}</em></code>) qui est ici en charge de l'affichage du résultat. En effet, toutes les balises de la forme <code><em>[#...&lt;]</em></code> sont censées ne produire aucun affichage dans le document de sortie. Il est ainsi possible de rajouter des commentaires en dehors des commandes <code>dyndoc</code> (ici, déinition de la fonction <code>hello</code>) comme cela a été fait dans le contenu de la balise <code><em>[#&lt;]</em></code>. Sans rentrer dans les détails, notons que cette fonction a un seul paramètre <code>name</code> avec pour valeur par défaut <code>Miss</code>. Toutes les balises <code>dyndoc</code> suivant la dernière balise <code><em>[#,]</em></code> forment le corps de la fonction qui sera executé à chaque futur appel de la fonction.</p>
<p>La quatrième partie fait tout d'abord appel par 2 fois à la fonction <code>hello</code>. La première forme <code><em>{#hello#}</em></code> correspond à l'appel de la fonction sans aucun argument pour le paramètre <code>name</code>. La valeur par défaut est ainsi utilisée. Le deuxième appel est lui fourni avec un nouvel argument pour le paramètre <code>name</code>. Les deux dernières lignes affichées permettent d'extraire successivement la variable <code>miss</code> en <code>ruby</code> (via <code><em>Miss Ruby</em></code>) et <code>mister</code> en <code>R</code> (via <code><em>MisteR</em></code>). Les différentes commandes d'extraction sont <code><em>:{...}</em></code> (équivalent à <code><em>:{...}</em></code> ou <code><em>:{...}</em></code>) pour des variables <code>ruby</code>, <em>:r{...}</em> (équivalent à <em>#r{...}</em>) pour des variables <code>R</code> et <code><em>#{...}</em></code> pour de variables <code>dyndoc</code>. L'usage de variable <code>dyndoc</code> n'a été introduit actuellement qu'à travers le paramètre <code>name</code> de la fonction <code>hello</code>. Notons l'usage de <code><em>#{name}</em></code> dans le corps de la fonction <code>hello</code> pour extraire le contenu du paramètre <code>name</code> (considéré par <code>dyndoc</code> comme une variable).</p>
<p>Le dernier commentaire porte sur un aspect de présentation du code <code>dyndoc</code> concernant les balises du type <code><em>[#&gt;]</em></code>. En effet, le contenu associé à cette balise commence normalement par le premier caractère à droite jusqu'au caractère précédent la prochaine balise incluant les caractères spéciaux invisibles de tabulation et de retour à la ligne. Afin de permettre une présentation plus agréable du code <span class="citation">@dyndoc</span>@, les règles suivantes ont été introduites :</p>
<ul>
<li>le contenu associé à une balise (du type <code><em>[#&gt;]</em></code>) peut être délimité entre un crochet ouvert (précédé par des espaces facultatifs) et un crochet fermé (suivi par des espaces facultatifs)</li>
<li>lorsque tout espace commençant une ligne suivi du caractère |, ceux-ci sont automatiquement supprimés</li>
<li>lorsque toute fin de ligne (i.e. un retour de ligne \n) précédé par le caractère |, ceux sont automatiquement supprimés.</li>
</ul>
<p>Ces régles ont été appliquées dans l'exemple introductif à la fois dans le corps de la fonction <span class="citation">@hello</span>@ ainsi que pour la dernière balise d'affichage <code><em>[#&gt;]</em></code>.</p>
<h3 id="le-même-exemple-avec-appel-dune-librairie-dyndoc">Le même exemple avec appel d'une librairie <code>dyndoc</code></h3>
<p>Si les deux codes suivants sont respectivement enregistrés dans les fichier <code>helloLib.dyn</code> et <code>helloBis.dyn</code> placés dans le même répertoire courant</p>
<pre class="solarized"><span class="line-numbers">   1 </span> {#<span class="Keyword">def</span>]hello[#<span class="Keyword">,</span>]name[Miss][#<span class="Keyword">&gt;</span>]<span class="DiffInserted"></span>
<span class="line-numbers">   2 </span> <span class="DiffInserted"><span class="Invalid">  <span class="Invalid">[</span></span>from Dyn, Hello <span class="Comment">#{</span><span class="Variable">name</span><span class="Comment">}</span><span class="Invalid"><span class="Invalid">]</span></span></span>
<span class="line-numbers">   3 </span> <span class="DiffInserted"></span>[#}
</pre>
<pre class="solarized"><span class="line-numbers">   1 </span> [#<span class="Keyword">require</span>]helloLib
<span class="line-numbers">   2 </span> [#<span class="Keyword">main</span>][#<span class="Keyword">r&lt;</span>]<span class="Variable">who</span> <span class="Keyword">&lt;-</span> <span class="QuotedString"><span class="Quotes">&quot;</span>MisteR<span class="Quotes">&quot;</span></span>[#<span class="Keyword">rb&lt;</span>] who <span class="Keyword">=</span> <span class="QuotedString"><span class="RubyPunctuationSection">&quot;</span>Miss Ruby<span class="RubyPunctuationSection">&quot;</span></span>
<span class="line-numbers">   3 </span> [#<span class="Keyword">&gt;</span>]<span class="DiffInserted"></span>
<span class="line-numbers">   4 </span> <span class="DiffInserted"></span>
<span class="line-numbers">   5 </span> <span class="DiffInserted"><span class="Invalid">  <span class="Invalid">[</span></span><span class="DiffInserted">{#</span><span class="Keyword">hello</span><span class="DiffInserted">#}</span></span>
<span class="line-numbers">   6 </span> <span class="DiffInserted"><span class="Invalid">  <span class="Invalid">|</span></span><span class="DiffInserted">{#</span><span class="TagName">hello</span><span class="DiffInserted">]</span>Mister<span class="DiffInserted">[#</span><span class="DiffInserted">}</span></span>
<span class="line-numbers">   7 </span> <span class="DiffInserted"><span class="Invalid">  <span class="Invalid">|</span></span>from ruby, Hello <span class="Comment">:{</span><span class="Variable">who</span><span class="Comment">}</span></span>
<span class="line-numbers">   8 </span> <span class="DiffInserted"><span class="Invalid">  <span class="Invalid">|</span></span>from R, Hello <span class="Comment">:r{</span><span class="Variable">who</span><span class="Comment">}</span><span class="Invalid"><span class="Invalid">]</span></span></span>
</pre>
<p>alors la ligne de commmande <code>dyn helloBis.dyn</code> produirait exactement la même sortie que précédemment. Remarquons que toutes les parties de code inutiles pour l'obtention du résultat ont été retirées dans cet exemple.</p>
<p>Le point important à souligner est que <code>dyndoc</code> permet de créer ses propres outils de &quot;reporting&quot; que l'on peut placer dans des fichiers (appelés librairies <code>dyndoc</code>) réutilisables par l'utilisateur dans ses documents source. Nous verrons plus tard que <code>dyndoc</code> dispose aussi d'un mécanisme de programmation orientée objet (assez similaire à celui du <code>R</code>).</p>
<p>Enfin, le document source <code>helloBis.dyn</code> nous indique la structure principale d'un document <code>dyndoc</code> (voir Concepts généraux pour plus de détails). Dans l'exemple, Les balises prioritaires sont <code><em>[#require]</em></code> et <code><em>[#main]</em></code> (équivalent à <code><em>[#content]</em></code>). Les autres balises <code><em>[#r&lt;]</em></code>, <code><em>[#rb&lt;]</em></code>, <code><em>[#&lt;]</em></code> et <code><em>[#&gt;]</em></code> sont des sous-balises attachées à la balise <code><em>[#main]</em></code> représentant le contenu principal du document source. La balise <code><em>[#require]</em></code> permet de charger des librairies <code>dyndoc</code> avant le traitement du contenu principal. Pour un document <code>latex</code> par exemple, il existe au même niveau de priorité les balises <code><em>[#title]</em></code>, <code><em>[#package]</em></code> et <code><em>[#preamble]</em></code> (par exemples) qui permettent respectivement de définir la partie titre (auteur et date inclus), la partie <code>\usepackage</code> et la partie préliminaire (appelé preamble en <code>latex</code>) d'un document de sortie <code>latex</code>.</p>
